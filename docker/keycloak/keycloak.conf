# ============================================
# Keycloak Configuration File
# AI Infrastructure Project
# ============================================

# Database Configuration
# Using PostgreSQL as the backend database
db=postgres
db-pool-initial-size=5
db-pool-min-size=5
db-pool-max-size=20

# HTTP/HTTPS Configuration
# In production, set http-enabled=false and configure HTTPS
http-enabled=true
http-port=8080
http-relative-path=/auth
# https-port=8443
# https-certificate-file=/path/to/cert.pem
# https-certificate-key-file=/path/to/key.pem

# Hostname Configuration
# hostname=auth.example.com
hostname-strict=false
hostname-strict-https=false
hostname-strict-backchannel=false

# Proxy Configuration
# edge - Keycloak is behind a reverse proxy (NGINX)
proxy=edge
proxy-address-forwarding=true

# Health and Metrics
health-enabled=true
metrics-enabled=true

# Logging Configuration
log-level=INFO
log-console-output=default
log-console-format=%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{3.}] (%t) %s%e%n
log-console-color=false

# Security Configuration
# Session and token settings
spi-sticky-session-encoder-infinispan-should-attach-route=false

# Feature flags
# features=token-exchange,admin-fine-grained-authz
# features-disabled=impersonation

# Cache Configuration
cache=ispn
cache-stack=tcp

# Transaction timeout (in seconds)
transaction-xa-enabled=true

# Theme Configuration
spi-theme-static-max-age=-1
spi-theme-cache-themes=true
spi-theme-cache-templates=true

# Email Configuration (optional - configure when needed)
# spi-email-template-provider=freemarker
# spi-email-template-freemarker-enabled=true

# Events Configuration
spi-events-listener-jboss-logging-success-level=info
spi-events-listener-jboss-logging-error-level=warn

# User Profile
# Disable legacy user profile to use new declarative user profile
spi-user-profile-legacy-user-profile-enabled=false

# Connection Pool Settings
# These can be tuned based on load
spi-connections-jpa-legacy-initialize-empty=true
spi-connections-jpa-legacy-migration-strategy=update

# Performance Tuning
# Increase these values for production
# spi-connections-infinispan-quarkus-site-name=site1
# spi-connections-infinispan-default-embedded-site-name=site1

# Development mode settings (remove in production)
# These are set via command-line in docker-compose for dev mode

